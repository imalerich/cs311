package cs311.hw7.graph;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Set;

public class Graph<V, E> implements IGraph<V, E> {
	
	/**
	 * List of vertices given by vertex name keys.
	 */
	private HashMap<String, IGraph.Vertex<V>> vertices;
	
	/**
	 * Uses the from vertex name as a key into a list of edges extending from that vertex to another vertex.
	 */
	private HashMap<String, Set<IGraph.Edge<E>>> edges;
	
	/***
	 * True if this graph is currently in directed mode, False otherwise.
	 */
	private boolean directed;
	
	/**
	 * Constructs a new empty directed graph.
	 */
	Graph() {
		vertices = new HashMap<String, IGraph.Vertex<V>>();
		edges = new HashMap<String, Set<IGraph.Edge<E>>>();
		directed = true;
	}
	
	/**
	 * Constructs a new empty graph.
	 * @param Directed If true the resulting graph will be directed, if false it will be undirected.
	 */
	Graph(boolean Directed) {
		vertices = new HashMap<String, IGraph.Vertex<V>>();
		edges = new HashMap<String, Set<IGraph.Edge<E>>>();
		directed = Directed;
	}

	@Override
	public void setDirectedGraph() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public void setUndirectedGraph() {
		// TODO Auto-generated method stub
		
	}

	@Override
	public boolean isDirectedGraph() {
		return directed;
	}

	@Override
	public void addVertex(String vertexName) throws DuplicateVertexException {
		if (vertices.containsKey(vertexName)) {
			throw new DuplicateVertexException();
		}
		
		// Add our vertex as well as a new set of edges extending from that vertex.
		vertices.put(vertexName, new IGraph.Vertex<V>(vertexName, null));
		edges.put(vertexName, new HashSet<IGraph.Edge<E>>());
	}

	@Override
	public void addVertex(String vertexName, V vertexData) throws DuplicateVertexException {
		if (vertices.containsKey(vertexName)) {
			throw new DuplicateVertexException();
		}
		
		// Add our vertex as well as a new set of edges extending from that vertex.
		vertices.put(vertexName, new IGraph.Vertex<V>(vertexName, vertexData));
		edges.put(vertexName, new HashSet<IGraph.Edge<E>>());
	}

	@Override
	public void addEdge(String vertex1, String vertex2) throws DuplicateEdgeException, NoSuchVertexException {
		// First we need to make sure each of our vertices exists.
		if (!vertices.containsKey(vertex1) || !vertices.containsKey(vertex2)) {
			throw new NoSuchVertexException();
		}
		
		// Get the set of edges extending from vertex1.
		Set<IGraph.Edge<E>> e = edges.get(vertex1);
		
		// Next find the list of edges extending from vertex1, and add the edge going to vertex2.
		edges.get(vertex1).add(new IGraph.Edge<E>(vertex1, vertex2, null));
	}

	@Override
	public void addEdge(String vertex1, String vertex2, E edgeData)
			throws DuplicateEdgeException, NoSuchVertexException {
		// First we need to make sure each of our vertices exists.
		if (!vertices.containsKey(vertex1) || !vertices.containsKey(vertex2)) {
			throw new NoSuchVertexException();
		}
		
		// Next find the list of edges extending from vertex1, and add the edge going to vertex2.
		edges.get(vertex1).add(new IGraph.Edge<E>(vertex1, vertex2, edgeData));
	}

	@Override
	public V getVertexData(String vertexName) throws NoSuchVertexException {
		if (!vertices.containsKey(vertexName)) {
			throw new NoSuchVertexException();
		}

		return vertices.get(vertexName).getVertexData();
	}

	@Override
	public void setVertexData(String vertexName, V vertexData) throws NoSuchVertexException {
		if (!vertices.containsKey(vertexName)) {
			throw new NoSuchVertexException();
		}

		// Need to overwrite the old vertex with the new data, but don't touch the edge
		// data as you would with the addVertex method.
		vertices.put(vertexName, new IGraph.Vertex<V>(vertexName, vertexData));
	}

	@Override
	public E getEdgeData(String vertex1, String vertex2) throws NoSuchVertexException, NoSuchEdgeException {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public void setEdgeData(String vertex1, String vertex2, Object edgeData)
			throws NoSuchVertexException, NoSuchEdgeException {
		// TODO Auto-generated method stub
		
	}

	@Override
	public IGraph.Vertex<V> getVertex(String VertexName) {
		return vertices.get(VertexName);
	}

	@Override
	public IGraph.Edge<E> getEdge(String vertexName1, String vertexName2) {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public List<IGraph.Vertex<V>> getVertices() {
		return new ArrayList<IGraph.Vertex<V>>(vertices.values());
	}

	@Override
	public List<IGraph.Edge<E>> getEdges() {
		return null;
	}

	@Override
	public List<IGraph.Vertex<V>> getNeighbors(String vertex) {
		// TODO Auto-generated method stub
		return null;
	}
}
